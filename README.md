# Индивидуальная WordPress-тема для проекта "{NAME}"

# После настройки удалить эту секцию из README

Отредактировать под проект файлы: этот файл, style.css, functions.php, screenshot.png.

По потребности: настроить ЧПУ, убрать комментирование.

При работе на локальной сервере включить дебаг:

```php
define( 'WP_DEBUG', true );
define( 'WP_DEBUG_LOG', true );
define( 'WP_DEBUG_DISPLAY', false );
define( 'WP_ENVIRONMENT_TYPE', 'local' );
define( 'AUTOMATIC_UPDATER_DISABLED', true );
```

## Структура проекта

```
├── .github             # Файлы CI/CD проекта
├── .vscode             # Файлы готовых сниппетов
├── backend/            # PHP функционал темы
├── gulp/               # Файлы конфигов gulp-сборщика
├── assets/             # Статичные файлы темы и файлы для препроцессора
└── templates/          # Файлы шаблона темы
```

## Фронтэнд

- Для начала работы у вас должент быть установлен `Node.js` не ниже 16 версии
- Вся разработка ведётся в директории `assets/src`
- Итоговый код попадает в директорию `assets/build`
- В папке `assets/temp` помещается временный код

В папке `src`

```
├── src/                          # Исходники для работы
│   ├── js                        # Скрипты
│   │   └── main.js               # Главный скрипт, куда подключаются все компоненты через import
│   │   ├── _functions.md         # файл с готовыми функциями на js
│   │   ├── _components.js        # файл с подключениями компонентов
│   │   ├── components            # js-компоненты
│   ├── scss                      # Стили сайта (препроцессор sass в scss-синтаксисе)
│   │   └── main.scss             # Главный файл стилей
│   │   └── vendor.scss           # Файл для подключения стилей библиотек из папки vendor
│   │   └── _fonts.scss           # Файл для подключения шрифтов (можно использовать миксин)
│   │   └── _mixins.scss          # Файл для подключения миксинов из папки mixins
│   │   └── _vars.scss            # Файл для написания css- или scss-переменных
│   │   └── _settings.scss        # Файл для написания глобальных стилей
│   │   ├── components            # scss-компоненты, которые имеют общее назначение в проекте. Например, _site-header, _site-footer и т.д.
│   │   ├── pages                 # scss-компоненты, относящиеся к конкретным страницам. Содержит вложенные папки по названию конкретных разделов сайта
│   │   ├── mixins                # папка для сохранения готовых scss-компонентов
│   │   ├── vendor                # папка для хранения локальных css-стилей библиотек
│   ├── partials                  # папка для хранения html-частей страницы
│   ├── img                       # папка для хранения картинок
│   │   ├── svg                   # специальная папка для преобразования svg в спрайт
│   ├── resources                 # папка для хранения иных ассетов - php, видео-файлы, favicon и т.д.
│   │   ├── fonts                 # папка для хранения шрифтов в формате woff2
```

### Основные команды для работы

- `npm i` или `npm install` - установка сборки.
- `npm run dev` - запуск системы сборки и последующим слежением за изменением файлов + без улучшайзеров.
- `npm run dev:express` - одновременно с системой сборки запуск тестового express сервера для mock-данных
- `npm run build` - запуск системы сборки без слежения за файлами, чтобы скомпилировать файлы для темы + запуск оптимизации картинок и другие улучшайзеры.

### Работа с CSS

В сборке используется препроцессор **sass** в синтаксисе **scss**.

Стили, написанные в **components**, следует подключать в **main.scss**.
**ВАЖНО:** Обязательно удалить стили, которые написаны в **main.scss** для `.page__body`.

Чтобы подключить сторонние css-файлы (библиотеки) - положите их в папку **vendor** и подключите в файле **\_vendor.scss**

В файл **\_vendor.scss** так же подключаются файлы стилей всех npm-модулей из папки **node_modules**

Если ты хочешь создать свой миксин - делайте это в папке **mixins**, а затем подключай в файл **\_mixins.scss**.

> Все файлы из папок components и pages автоматически собираются в main.scss. Ничего вручную подключать не нужно

В итоговой папке **build/css** создаются два файла: <br> **main.css** - для стилей страницы, <br> **vendor.css** - для стилей всех библиотек, использующихся в проекте.

### Работа с JavaScript

Для сборки JS-кода используется webpack.

JS-код лучше делить на компоненты - небольшие js-файлы, которые содержат свою, изолированную друг от друга реализацию. Такие файлы помещай в папку **components**, а потом импортируйте в файл **\_components.js**

В файле **main.js** ничего менять не нужно, он сделан просто как результирующий.

Подключать библиотеки в сборку можно только с помощью npm. Для этого установи нужный пакет с помощью его команды, создайте в папке **components** файлик, импортируй туда библиотеку и работай с ней. Не забудь импортировать этот файл в файл **\_components.js**.

### Работа со шрифтами

В сборке реализована поддержка только формата **woff2**, т.к. другие форматы шрифтов не актуальны (это значит, что в миксине подключения шрифтов используется только данный формат).

Загружай файлы **woff2** в папку **resources/fonts**, а затем вызывай миксин `@font-face` в файле **\_fonts.scss**.

Также не забудь прописать эти же шрифты в `<link preload>` в `site-header.php`.

## Работа с изображениями

Любые изображения, кроме **favicon** клади в папку **img**.

Если нужно сделать svg-спрайт, клади нужные для спрайта svg-файлы в папку **img/svg**. При этом, такие атрибуты как fill, stroke, style будут автоматически удаляться. Иные svg-файлы просто оставляйте в папке **img**.

В сборке доступна поддержка **webp** формата. Подключить его вы можете через тег `picture`. Для background можно использовать обычные **jpg** или **png**, либо использовать `image-set` там, где это [возможно](https://caniuse.com/css-image-set).

### Работа с иными ресурсами

Любые ресурсы (ассеты) проекта, под которые не отведена соответствующая папка, должны храниться в папке **resources**. Это могут быть видео-файлы, favicon и прочие.

### Рекомендуемые плагины для VS Code

В сборке реализована поддержка редактора кода VS Code. Так, при открытии папки со сборкой в VS Code, редактор предложит вам ранее не установленные плагины, которые подойдут для корректной работы сборки.

Самый важный из них – **projects snippets**, этот плагин "включает" локально написанные сниппеты для сборки. Данный плагин не всегда работает корректно, в этом случае просто перезапустите VS Code.

### Локальные сниппеты

Для удобства и быстроты разработки были добавление локальные сниппеты (находятся в папке .vscode/snippets), которые работают благодаря плагину, описанному выше. Все сниппеты начинаются с префикса **g-**.

Некоторые сниппеты тесно связаны с scss-миксинами, например кнопка-бургер. Сниппет **g-burger** создаст вам html-разметку бургера, а подключение миксина **@include burger** добавит для него стили, что крайне удобно.

### Готовые модули

В сборке присутствуют готовые, часто-используемые модули под различные задачи. Ниже будет перечислен уже добавленный функционал.

**Внимание!** В файле _functions.js_ описаны лишь подключения всех нужных модулей. Рекомендуется использовать все это в отдельных файлах. Например, если вам нужно создать модальное окно, создаете файл _modal.js_ в папке components, подключаете его в файл components.js и уже в файле _modal.js_ используете код подключения.


## Бэкенд

Используется упрощённая форма [архитектурного шаблона Porto](https://github.com/dnsoftware/porto_ru).

Основной функционал (базовый, общий) хранится в папке `ship`, например "Фейкер", "Апгрейдер", различные базовые преднастройки темы (перемещаемые от проекта к проекту) и так далее.

В папке `containers` находится бизнес-логика, например "Проекты", "Профиль", "Формы" и так далее, определяющие работу сайта как приложения.

```
/ship/
├── ACF/                # Преднастройки плагина Advanced Custom Fields
├── Core/               # Основные преднастройки сайта
├── Faker/              # Модуль для генерации фейковых сущностей, например новостей
├── Upgrade/            # Модуль автоматического обновления параметров сайта
├── Other/              # Функционал, который нельзя распределить по модулям
└── … другие модули по необходимости
/containers/
├── Projects/           # CTP "Project" с сопутствующим функционалом
├── CTP_Projects/       # Или так
├── Profile/            # Страница "Profile" с сопутствующим функционалом
├── Page_Profile/       # Или так
├── Front_Page/         # Функционал главной страницы
└── … другие контейнеры (сущности) по необходимости
```

## WP CLI команды

Чтобы воспользоваться данными командами, у вас должен быть установлен [WP CLI](https://wp-kama.ru/handbook/wp-cli) на сервере.

### Удаление любых типов записей

```shell
# \CustomTheme\Faker\Main::delete_posts()
wp dev post delete <ctp_name> [--yes]
wp dev post delete project
wp dev post delete project --yes
```

### Создание json-файла группы полей ACF

```shell
# \CustomTheme\ACF\ACF::make_json()
wp dev acf make json  "Настройки одиночной новости" news_single_settings
```
